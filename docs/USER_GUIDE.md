# VulWeb 用户手册

## 目录

1. [系统概述](#系统概述)
2. [首页Dashboard](#首页dashboard)
3. [模型管理](#模型管理)
4. [数据集管理](#数据集管理)
5. [训练任务](#训练任务)
6. [结果展示](#结果展示)
7. [AI对话](#ai对话)
8. [系统设置](#系统设置)

## 系统概述

VulWeb是一个代码漏洞检测模型管理系统，提供完整的模型训练、管理和评估功能。

### 主要功能

- 🔧 **模型管理**: 上传、查看、删除ML模型
- 📊 **数据集管理**: 管理训练数据集，自动分析统计
- 🚀 **训练任务**: 创建训练任务，实时监控进度
- 📈 **结果展示**: 可视化训练结果和性能指标
- 💬 **AI对话**: 智能助手，提供操作指导
- ⚙️ **系统设置**: 配置AI服务和系统参数

## 首页Dashboard

### 统计概览

首页显示系统的关键统计信息：
- 模型总数
- 数据集数量
- 训练任务总数
- 运行中的任务数

### 快速操作

提供快捷按钮，一键跳转到：
- 上传模型
- 上传数据集
- 开始训练
- AI对话

### 最近活动

显示最近的训练任务及其状态。

## 模型管理

### 上传模型

1. 点击"模型管理"进入模型列表页
2. 点击右上角"上传模型"按钮
3. 填写模型信息：
   - **模型名称** (必填): 为模型起一个描述性的名称
   - **描述**: 模型的详细说明
   - **版本号**: 例如 1.0.0, 2.1.0
   - **模型类型**: 选择漏洞检测或细粒度定位
4. 选择模型文件
5. 点击"上传"

### 支持的模型格式

- `.pkl` - Pickle格式 (scikit-learn模型)
- `.pt` / `.pth` - PyTorch模型
- `.h5` - Keras/TensorFlow模型
- `.onnx` - ONNX格式模型

### 查看模型信息

每个模型卡片显示：
- 模型名称和描述
- 版本号
- 模型类型
- 准确率（如已训练）
- 创建时间

### 删除模型

点击模型卡片右上角的删除图标，确认后删除。

> ⚠️ **注意**: 删除模型将同时删除模型文件，此操作不可恢复。

## 数据集管理

### 上传数据集

1. 点击"数据集管理"
2. 点击"上传数据集"
3. 填写信息：
   - **数据集名称** (必填)
   - **描述**: 数据集的说明
4. 选择数据集文件
5. 点击"上传"

系统会自动分析数据集内容。

### 支持的数据格式

#### JSON格式

```json
[
  {
    "code": "代码片段",
    "label": 1,
    "vulnerability_type": "SQL Injection"
  },
  {
    "code": "代码片段",
    "label": 0,
    "vulnerability_type": "None"
  }
]
```

字段说明：
- `code`: 代码内容
- `label`: 标签 (1=有漏洞, 0=安全)
- `vulnerability_type`: 漏洞类型

#### CSV格式

```csv
code,label,vulnerability_type
"代码片段",1,"SQL Injection"
"代码片段",0,"None"
```

### 数据集统计信息

每个数据集卡片显示：
- 文件格式
- 文件大小
- 样本总数
- 漏洞样本数 / 安全样本数
- 预处理状态
- 上传时间

### 删除数据集

点击数据集卡片右上角的删除图标。

> ⚠️ **注意**: 删除数据集将同时删除文件，正在使用该数据集的训练任务可能失败。

## 训练任务

### 创建训练任务

1. 确保已上传模型和数据集
2. 点击"训练任务"
3. 点击"创建训练任务"
4. 配置训练参数：
   - **任务名称**: 为任务命名
   - **选择模型**: 从已上传的模型中选择
   - **选择数据集**: 从已上传的数据集中选择
   - **训练轮次**: 设置epochs数量 (1-1000)
5. 点击"创建并开始训练"

系统将自动开始训练任务。

### 监控训练进度

在训练任务列表中，可以看到：
- 任务名称和状态
- 进度条显示完成百分比
- 当前轮次 / 总轮次
- 当前准确率
- 创建时间

### 任务状态

- 🔵 **等待中** (pending): 任务已创建，等待开始
- 🟡 **运行中** (running): 训练正在进行
- 🟢 **已完成** (completed): 训练成功完成
- 🔴 **失败** (failed): 训练出错

### 查看训练指标

点击"查看"按钮打开指标对话框，显示：

#### 当前指标卡片
- Loss
- Accuracy
- Validation Loss
- Validation Accuracy

#### 训练曲线
- Loss变化趋势图 (训练Loss vs 验证Loss)
- Accuracy变化趋势图 (训练Accuracy vs 验证Accuracy)

图表使用ECharts绘制，支持缩放、数据点提示等交互功能。

### 停止训练

对于运行中的任务，可以点击"停止"按钮中止训练。

### 删除任务

点击"删除"按钮删除训练任务记录。

> 💡 **提示**: 训练完成后，系统会自动更新模型的性能指标。

## 结果展示

### 查看训练历史

"结果展示"页面列出所有已完成的训练任务。

表格显示：
- 任务名称
- 使用的模型
- 使用的数据集
- 训练轮次
- 最终准确率
- 训练时长
- 完成时间

### 查看详细结果

点击"查看详情"打开详情对话框：

#### 基本信息
- 任务配置
- 训练时长
- 状态

#### 性能指标
- 最终Loss
- 最终Accuracy
- 验证Loss
- 验证Accuracy

#### 训练曲线
- 完整的Loss变化趋势
- 完整的Accuracy变化趋势

可以对比训练集和验证集的性能，评估模型是否过拟合。

## AI对话

### 功能说明

AI对话智能体可以：
- 回答系统使用问题
- 提供操作指导
- 查询系统状态
- 执行简单命令（开发中）

### 使用方式

1. 点击"AI对话"进入对话页面
2. 在输入框输入问题
3. 按Enter发送（Shift+Enter换行）
4. AI会根据问题提供回答

### 快捷问题

页面底部提供常见问题快捷入口：
- 如何上传模型？
- 训练任务的状态是什么？
- 有多少个数据集？
- 如何创建训练任务？

点击快捷问题即可快速提问。

### 支持的问题类型

#### 模型相关
- "如何上传模型？"
- "系统有多少个模型？"
- "模型文件支持什么格式？"

#### 数据集相关
- "如何上传数据集？"
- "数据集格式要求是什么？"
- "当前有多少个数据集？"

#### 训练相关
- "如何创建训练任务？"
- "训练任务的状态是什么？"
- "如何监控训练进度？"

#### 系统相关
- "系统有哪些功能？"
- "如何使用系统？"

### 清空对话

点击右上角"清空对话"按钮可以清除所有历史对话。

## 系统设置

### AI API配置

配置AI对话服务：

1. **AI服务商**: 选择使用的AI服务
   - 通义千问 (Qwen)
   - 文心一言 (ERNIE)
   - 智谱AI (ChatGLM)
   - 百度千帆
   - 本地部署

2. **API Key**: 输入服务商提供的API密钥

3. **API Endpoint**: API服务地址

4. **模型**: 选择使用的具体模型

5. 点击"保存配置"

6. 点击"测试连接"验证配置

### 获取API Key

#### 通义千问
1. 访问 https://tongyi.aliyun.com/
2. 注册/登录阿里云账号
3. 开通DashScope服务
4. 获取API Key

#### 文心一言
1. 访问 https://yiyan.baidu.com/
2. 登录百度账号
3. 创建应用
4. 获取API Key和Secret Key

#### 智谱AI
1. 访问 https://open.bigmodel.cn/
2. 注册/登录
3. 创建API Key

### 系统配置

#### 上传文件限制
设置单个文件的最大上传大小（MB）。

#### 训练超时时间
设置训练任务的最大执行时间（秒）。

#### 自动刷新
开启后，训练状态会自动刷新。

#### 刷新间隔
设置自动刷新的时间间隔（秒）。

### 数据管理

#### 导出数据
导出系统数据到文件（开发中）。

#### 清理缓存
清理系统缓存文件。

#### 重置系统
重置所有系统配置到默认值。

> ⚠️ **警告**: 重置系统不会删除已上传的模型和数据集，只会重置配置。

## 最佳实践

### 数据集准备

1. **数据质量**: 确保标注准确
2. **数据平衡**: 漏洞样本和安全样本比例适当
3. **数据量**: 建议至少1000个样本
4. **格式规范**: 遵循JSON或CSV格式规范

### 模型训练

1. **选择合适的epochs**: 从小开始，观察收敛情况
2. **监控过拟合**: 关注训练集和验证集的差异
3. **保存检查点**: 定期保存训练进度
4. **参数调优**: 根据结果调整超参数

### 系统使用

1. **定期备份**: 备份重要的模型和数据
2. **清理旧数据**: 删除不需要的训练任务
3. **查看日志**: 出现问题时检查日志文件
4. **更新系统**: 关注系统更新

## 故障排除

### 上传失败

**可能原因**:
- 文件格式不支持
- 文件大小超限
- 网络问题

**解决方法**:
1. 检查文件格式
2. 调整系统配置中的文件大小限制
3. 重试上传

### 训练失败

**可能原因**:
- 数据格式错误
- 模型不兼容
- 内存不足

**解决方法**:
1. 检查数据集格式
2. 查看训练任务的错误信息
3. 减少batch size或模型复杂度

### AI对话无响应

**可能原因**:
- API Key未配置
- API服务不可用
- 网络问题

**解决方法**:
1. 在系统设置中配置API Key
2. 测试API连接
3. 检查网络连接

## 附录

### 快捷键

- `Ctrl + /`: 打开帮助
- `Alt + H`: 返回首页
- `Alt + M`: 打开模型管理
- `Alt + D`: 打开数据集管理
- `Alt + T`: 打开训练任务

### 常见术语

- **Epoch**: 训练轮次，完整遍历一次数据集
- **Loss**: 损失值，越小越好
- **Accuracy**: 准确率，越高越好
- **Validation**: 验证集，用于评估模型泛化能力
- **Overfitting**: 过拟合，模型在训练集上表现好但泛化差

### 技术支持

- GitHub: https://github.com/Accessiry/vulweb
- Issues: https://github.com/Accessiry/vulweb/issues
- Email: support@vulweb.com
